{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.signTransaction = exports.createTransaction = exports.SCHEMA = exports.Action = exports.SignedTransaction = exports.Transaction = exports.deleteAccount = exports.deleteKey = exports.addKey = exports.stake = exports.transfer = exports.functionCall = exports.deployContract = exports.createAccount = exports.IAction = exports.functionCallAccessKey = exports.fullAccessKey = exports.AccessKey = exports.AccessKeyPermission = exports.FullAccessPermission = exports.FunctionCallPermission = void 0;\n\nconst js_sha256_1 = __importDefault(require(\"js-sha256\"));\n\nconst enums_1 = require(\"./utils/enums\");\n\nconst serialize_1 = require(\"./utils/serialize\");\n\nconst key_pair_1 = require(\"./utils/key_pair\");\n\nclass FunctionCallPermission extends enums_1.Assignable {}\n\nexports.FunctionCallPermission = FunctionCallPermission;\n\nclass FullAccessPermission extends enums_1.Assignable {}\n\nexports.FullAccessPermission = FullAccessPermission;\n\nclass AccessKeyPermission extends enums_1.Enum {}\n\nexports.AccessKeyPermission = AccessKeyPermission;\n\nclass AccessKey extends enums_1.Assignable {}\n\nexports.AccessKey = AccessKey;\n\nfunction fullAccessKey() {\n  return new AccessKey({\n    nonce: 0,\n    permission: new AccessKeyPermission({\n      fullAccess: new FullAccessPermission({})\n    })\n  });\n}\n\nexports.fullAccessKey = fullAccessKey;\n\nfunction functionCallAccessKey(receiverId, methodNames, allowance) {\n  return new AccessKey({\n    nonce: 0,\n    permission: new AccessKeyPermission({\n      functionCall: new FunctionCallPermission({\n        receiverId,\n        allowance,\n        methodNames\n      })\n    })\n  });\n}\n\nexports.functionCallAccessKey = functionCallAccessKey;\n\nclass IAction extends enums_1.Assignable {}\n\nexports.IAction = IAction;\n\nclass CreateAccount extends IAction {}\n\nclass DeployContract extends IAction {}\n\nclass FunctionCall extends IAction {}\n\nclass Transfer extends IAction {}\n\nclass Stake extends IAction {}\n\nclass AddKey extends IAction {}\n\nclass DeleteKey extends IAction {}\n\nclass DeleteAccount extends IAction {}\n\nfunction createAccount() {\n  return new Action({\n    createAccount: new CreateAccount({})\n  });\n}\n\nexports.createAccount = createAccount;\n\nfunction deployContract(code) {\n  return new Action({\n    deployContract: new DeployContract({\n      code\n    })\n  });\n}\n\nexports.deployContract = deployContract;\n\nfunction functionCall(methodName, args, gas, deposit) {\n  return new Action({\n    functionCall: new FunctionCall({\n      methodName,\n      args,\n      gas,\n      deposit\n    })\n  });\n}\n\nexports.functionCall = functionCall;\n\nfunction transfer(deposit) {\n  return new Action({\n    transfer: new Transfer({\n      deposit\n    })\n  });\n}\n\nexports.transfer = transfer;\n\nfunction stake(stake, publicKey) {\n  return new Action({\n    stake: new Stake({\n      stake,\n      publicKey\n    })\n  });\n}\n\nexports.stake = stake;\n\nfunction addKey(publicKey, accessKey) {\n  return new Action({\n    addKey: new AddKey({\n      publicKey,\n      accessKey\n    })\n  });\n}\n\nexports.addKey = addKey;\n\nfunction deleteKey(publicKey) {\n  return new Action({\n    deleteKey: new DeleteKey({\n      publicKey\n    })\n  });\n}\n\nexports.deleteKey = deleteKey;\n\nfunction deleteAccount(beneficiaryId) {\n  return new Action({\n    deleteAccount: new DeleteAccount({\n      beneficiaryId\n    })\n  });\n}\n\nexports.deleteAccount = deleteAccount;\n\nclass Signature extends enums_1.Assignable {}\n\nclass Transaction extends enums_1.Assignable {\n  encode() {\n    return serialize_1.serialize(exports.SCHEMA, this);\n  }\n\n  static decode(bytes) {\n    return serialize_1.deserialize(exports.SCHEMA, Transaction, bytes);\n  }\n\n}\n\nexports.Transaction = Transaction;\n\nclass SignedTransaction extends enums_1.Assignable {\n  encode() {\n    return serialize_1.serialize(exports.SCHEMA, this);\n  }\n\n  static decode(bytes) {\n    return serialize_1.deserialize(exports.SCHEMA, SignedTransaction, bytes);\n  }\n\n}\n\nexports.SignedTransaction = SignedTransaction;\n/**\n * Contains a list of the valid transaction Actions available with this API\n */\n\nclass Action extends enums_1.Enum {}\n\nexports.Action = Action;\nexports.SCHEMA = new Map([[Signature, {\n  kind: 'struct',\n  fields: [['keyType', 'u8'], ['data', [64]]]\n}], [SignedTransaction, {\n  kind: 'struct',\n  fields: [['transaction', Transaction], ['signature', Signature]]\n}], [Transaction, {\n  kind: 'struct',\n  fields: [['signerId', 'string'], ['publicKey', key_pair_1.PublicKey], ['nonce', 'u64'], ['receiverId', 'string'], ['blockHash', [32]], ['actions', [Action]]]\n}], [key_pair_1.PublicKey, {\n  kind: 'struct',\n  fields: [['keyType', 'u8'], ['data', [32]]]\n}], [AccessKey, {\n  kind: 'struct',\n  fields: [['nonce', 'u64'], ['permission', AccessKeyPermission]]\n}], [AccessKeyPermission, {\n  kind: 'enum',\n  field: 'enum',\n  values: [['functionCall', FunctionCallPermission], ['fullAccess', FullAccessPermission]]\n}], [FunctionCallPermission, {\n  kind: 'struct',\n  fields: [['allowance', {\n    kind: 'option',\n    type: 'u128'\n  }], ['receiverId', 'string'], ['methodNames', ['string']]]\n}], [FullAccessPermission, {\n  kind: 'struct',\n  fields: []\n}], [Action, {\n  kind: 'enum',\n  field: 'enum',\n  values: [['createAccount', CreateAccount], ['deployContract', DeployContract], ['functionCall', FunctionCall], ['transfer', Transfer], ['stake', Stake], ['addKey', AddKey], ['deleteKey', DeleteKey], ['deleteAccount', DeleteAccount]]\n}], [CreateAccount, {\n  kind: 'struct',\n  fields: []\n}], [DeployContract, {\n  kind: 'struct',\n  fields: [['code', ['u8']]]\n}], [FunctionCall, {\n  kind: 'struct',\n  fields: [['methodName', 'string'], ['args', ['u8']], ['gas', 'u64'], ['deposit', 'u128']]\n}], [Transfer, {\n  kind: 'struct',\n  fields: [['deposit', 'u128']]\n}], [Stake, {\n  kind: 'struct',\n  fields: [['stake', 'u128'], ['publicKey', key_pair_1.PublicKey]]\n}], [AddKey, {\n  kind: 'struct',\n  fields: [['publicKey', key_pair_1.PublicKey], ['accessKey', AccessKey]]\n}], [DeleteKey, {\n  kind: 'struct',\n  fields: [['publicKey', key_pair_1.PublicKey]]\n}], [DeleteAccount, {\n  kind: 'struct',\n  fields: [['beneficiaryId', 'string']]\n}]]);\n\nfunction createTransaction(signerId, publicKey, receiverId, nonce, actions, blockHash) {\n  return new Transaction({\n    signerId,\n    publicKey,\n    nonce,\n    receiverId,\n    actions,\n    blockHash\n  });\n}\n\nexports.createTransaction = createTransaction;\n/**\n * Signs a given transaction from an account with given keys, applied to the given network\n * @param transaction The Transaction object to sign\n * @param signer The {Signer} object that assists with signing keys\n * @param accountId The human-readable NEAR account name\n * @param networkId The targeted network. (ex. default, devnet, betanet, etc…)\n */\n\nasync function signTransactionObject(transaction, signer, accountId, networkId) {\n  const message = serialize_1.serialize(exports.SCHEMA, transaction);\n  const hash = new Uint8Array(js_sha256_1.default.sha256.array(message));\n  const signature = await signer.signMessage(message, accountId, networkId);\n  const signedTx = new SignedTransaction({\n    transaction,\n    signature: new Signature({\n      keyType: transaction.publicKey.keyType,\n      data: signature.signature\n    })\n  });\n  return [hash, signedTx];\n}\n\nasync function signTransaction(...args) {\n  if (args[0].constructor === Transaction) {\n    const [transaction, signer, accountId, networkId] = args;\n    return signTransactionObject(transaction, signer, accountId, networkId);\n  } else {\n    const [receiverId, nonce, actions, blockHash, signer, accountId, networkId] = args;\n    const publicKey = await signer.getPublicKey(accountId, networkId);\n    const transaction = createTransaction(accountId, publicKey, receiverId, nonce, actions, blockHash);\n    return signTransactionObject(transaction, signer, accountId, networkId);\n  }\n}\n\nexports.signTransaction = signTransaction;","map":{"version":3,"sources":["/Users/Julie/near/digital-war/frontend/node_modules/near-api-js/lib/transaction.js"],"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","signTransaction","createTransaction","SCHEMA","Action","SignedTransaction","Transaction","deleteAccount","deleteKey","addKey","stake","transfer","functionCall","deployContract","createAccount","IAction","functionCallAccessKey","fullAccessKey","AccessKey","AccessKeyPermission","FullAccessPermission","FunctionCallPermission","js_sha256_1","require","enums_1","serialize_1","key_pair_1","Assignable","Enum","nonce","permission","fullAccess","receiverId","methodNames","allowance","CreateAccount","DeployContract","FunctionCall","Transfer","Stake","AddKey","DeleteKey","DeleteAccount","code","methodName","args","gas","deposit","publicKey","accessKey","beneficiaryId","Signature","encode","serialize","decode","bytes","deserialize","Map","kind","fields","PublicKey","field","values","type","signerId","actions","blockHash","signTransactionObject","transaction","signer","accountId","networkId","message","hash","Uint8Array","default","sha256","array","signature","signMessage","signedTx","keyType","data","constructor","getPublicKey"],"mappings":"AAAA;;AACA,IAAIA,eAAe,GAAI,QAAQ,KAAKA,eAAd,IAAkC,UAAUC,GAAV,EAAe;AACnE,SAAQA,GAAG,IAAIA,GAAG,CAACC,UAAZ,GAA0BD,GAA1B,GAAgC;AAAE,eAAWA;AAAb,GAAvC;AACH,CAFD;;AAGAE,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,eAAR,GAA0BF,OAAO,CAACG,iBAAR,GAA4BH,OAAO,CAACI,MAAR,GAAiBJ,OAAO,CAACK,MAAR,GAAiBL,OAAO,CAACM,iBAAR,GAA4BN,OAAO,CAACO,WAAR,GAAsBP,OAAO,CAACQ,aAAR,GAAwBR,OAAO,CAACS,SAAR,GAAoBT,OAAO,CAACU,MAAR,GAAiBV,OAAO,CAACW,KAAR,GAAgBX,OAAO,CAACY,QAAR,GAAmBZ,OAAO,CAACa,YAAR,GAAuBb,OAAO,CAACc,cAAR,GAAyBd,OAAO,CAACe,aAAR,GAAwBf,OAAO,CAACgB,OAAR,GAAkBhB,OAAO,CAACiB,qBAAR,GAAgCjB,OAAO,CAACkB,aAAR,GAAwBlB,OAAO,CAACmB,SAAR,GAAoBnB,OAAO,CAACoB,mBAAR,GAA8BpB,OAAO,CAACqB,oBAAR,GAA+BrB,OAAO,CAACsB,sBAAR,GAAiC,KAAK,CAAnf;;AACA,MAAMC,WAAW,GAAG5B,eAAe,CAAC6B,OAAO,CAAC,WAAD,CAAR,CAAnC;;AACA,MAAMC,OAAO,GAAGD,OAAO,CAAC,eAAD,CAAvB;;AACA,MAAME,WAAW,GAAGF,OAAO,CAAC,mBAAD,CAA3B;;AACA,MAAMG,UAAU,GAAGH,OAAO,CAAC,kBAAD,CAA1B;;AACA,MAAMF,sBAAN,SAAqCG,OAAO,CAACG,UAA7C,CAAwD;;AAExD5B,OAAO,CAACsB,sBAAR,GAAiCA,sBAAjC;;AACA,MAAMD,oBAAN,SAAmCI,OAAO,CAACG,UAA3C,CAAsD;;AAEtD5B,OAAO,CAACqB,oBAAR,GAA+BA,oBAA/B;;AACA,MAAMD,mBAAN,SAAkCK,OAAO,CAACI,IAA1C,CAA+C;;AAE/C7B,OAAO,CAACoB,mBAAR,GAA8BA,mBAA9B;;AACA,MAAMD,SAAN,SAAwBM,OAAO,CAACG,UAAhC,CAA2C;;AAE3C5B,OAAO,CAACmB,SAAR,GAAoBA,SAApB;;AACA,SAASD,aAAT,GAAyB;AACrB,SAAO,IAAIC,SAAJ,CAAc;AAAEW,IAAAA,KAAK,EAAE,CAAT;AAAYC,IAAAA,UAAU,EAAE,IAAIX,mBAAJ,CAAwB;AAAEY,MAAAA,UAAU,EAAE,IAAIX,oBAAJ,CAAyB,EAAzB;AAAd,KAAxB;AAAxB,GAAd,CAAP;AACH;;AACDrB,OAAO,CAACkB,aAAR,GAAwBA,aAAxB;;AACA,SAASD,qBAAT,CAA+BgB,UAA/B,EAA2CC,WAA3C,EAAwDC,SAAxD,EAAmE;AAC/D,SAAO,IAAIhB,SAAJ,CAAc;AAAEW,IAAAA,KAAK,EAAE,CAAT;AAAYC,IAAAA,UAAU,EAAE,IAAIX,mBAAJ,CAAwB;AAAEP,MAAAA,YAAY,EAAE,IAAIS,sBAAJ,CAA2B;AAAEW,QAAAA,UAAF;AAAcE,QAAAA,SAAd;AAAyBD,QAAAA;AAAzB,OAA3B;AAAhB,KAAxB;AAAxB,GAAd,CAAP;AACH;;AACDlC,OAAO,CAACiB,qBAAR,GAAgCA,qBAAhC;;AACA,MAAMD,OAAN,SAAsBS,OAAO,CAACG,UAA9B,CAAyC;;AAEzC5B,OAAO,CAACgB,OAAR,GAAkBA,OAAlB;;AACA,MAAMoB,aAAN,SAA4BpB,OAA5B,CAAoC;;AAEpC,MAAMqB,cAAN,SAA6BrB,OAA7B,CAAqC;;AAErC,MAAMsB,YAAN,SAA2BtB,OAA3B,CAAmC;;AAEnC,MAAMuB,QAAN,SAAuBvB,OAAvB,CAA+B;;AAE/B,MAAMwB,KAAN,SAAoBxB,OAApB,CAA4B;;AAE5B,MAAMyB,MAAN,SAAqBzB,OAArB,CAA6B;;AAE7B,MAAM0B,SAAN,SAAwB1B,OAAxB,CAAgC;;AAEhC,MAAM2B,aAAN,SAA4B3B,OAA5B,CAAoC;;AAEpC,SAASD,aAAT,GAAyB;AACrB,SAAO,IAAIV,MAAJ,CAAW;AAAEU,IAAAA,aAAa,EAAE,IAAIqB,aAAJ,CAAkB,EAAlB;AAAjB,GAAX,CAAP;AACH;;AACDpC,OAAO,CAACe,aAAR,GAAwBA,aAAxB;;AACA,SAASD,cAAT,CAAwB8B,IAAxB,EAA8B;AAC1B,SAAO,IAAIvC,MAAJ,CAAW;AAAES,IAAAA,cAAc,EAAE,IAAIuB,cAAJ,CAAmB;AAAEO,MAAAA;AAAF,KAAnB;AAAlB,GAAX,CAAP;AACH;;AACD5C,OAAO,CAACc,cAAR,GAAyBA,cAAzB;;AACA,SAASD,YAAT,CAAsBgC,UAAtB,EAAkCC,IAAlC,EAAwCC,GAAxC,EAA6CC,OAA7C,EAAsD;AAClD,SAAO,IAAI3C,MAAJ,CAAW;AAAEQ,IAAAA,YAAY,EAAE,IAAIyB,YAAJ,CAAiB;AAAEO,MAAAA,UAAF;AAAcC,MAAAA,IAAd;AAAoBC,MAAAA,GAApB;AAAyBC,MAAAA;AAAzB,KAAjB;AAAhB,GAAX,CAAP;AACH;;AACDhD,OAAO,CAACa,YAAR,GAAuBA,YAAvB;;AACA,SAASD,QAAT,CAAkBoC,OAAlB,EAA2B;AACvB,SAAO,IAAI3C,MAAJ,CAAW;AAAEO,IAAAA,QAAQ,EAAE,IAAI2B,QAAJ,CAAa;AAAES,MAAAA;AAAF,KAAb;AAAZ,GAAX,CAAP;AACH;;AACDhD,OAAO,CAACY,QAAR,GAAmBA,QAAnB;;AACA,SAASD,KAAT,CAAeA,KAAf,EAAsBsC,SAAtB,EAAiC;AAC7B,SAAO,IAAI5C,MAAJ,CAAW;AAAEM,IAAAA,KAAK,EAAE,IAAI6B,KAAJ,CAAU;AAAE7B,MAAAA,KAAF;AAASsC,MAAAA;AAAT,KAAV;AAAT,GAAX,CAAP;AACH;;AACDjD,OAAO,CAACW,KAAR,GAAgBA,KAAhB;;AACA,SAASD,MAAT,CAAgBuC,SAAhB,EAA2BC,SAA3B,EAAsC;AAClC,SAAO,IAAI7C,MAAJ,CAAW;AAAEK,IAAAA,MAAM,EAAE,IAAI+B,MAAJ,CAAW;AAAEQ,MAAAA,SAAF;AAAaC,MAAAA;AAAb,KAAX;AAAV,GAAX,CAAP;AACH;;AACDlD,OAAO,CAACU,MAAR,GAAiBA,MAAjB;;AACA,SAASD,SAAT,CAAmBwC,SAAnB,EAA8B;AAC1B,SAAO,IAAI5C,MAAJ,CAAW;AAAEI,IAAAA,SAAS,EAAE,IAAIiC,SAAJ,CAAc;AAAEO,MAAAA;AAAF,KAAd;AAAb,GAAX,CAAP;AACH;;AACDjD,OAAO,CAACS,SAAR,GAAoBA,SAApB;;AACA,SAASD,aAAT,CAAuB2C,aAAvB,EAAsC;AAClC,SAAO,IAAI9C,MAAJ,CAAW;AAAEG,IAAAA,aAAa,EAAE,IAAImC,aAAJ,CAAkB;AAAEQ,MAAAA;AAAF,KAAlB;AAAjB,GAAX,CAAP;AACH;;AACDnD,OAAO,CAACQ,aAAR,GAAwBA,aAAxB;;AACA,MAAM4C,SAAN,SAAwB3B,OAAO,CAACG,UAAhC,CAA2C;;AAE3C,MAAMrB,WAAN,SAA0BkB,OAAO,CAACG,UAAlC,CAA6C;AACzCyB,EAAAA,MAAM,GAAG;AACL,WAAO3B,WAAW,CAAC4B,SAAZ,CAAsBtD,OAAO,CAACI,MAA9B,EAAsC,IAAtC,CAAP;AACH;;AACY,SAANmD,MAAM,CAACC,KAAD,EAAQ;AACjB,WAAO9B,WAAW,CAAC+B,WAAZ,CAAwBzD,OAAO,CAACI,MAAhC,EAAwCG,WAAxC,EAAqDiD,KAArD,CAAP;AACH;;AANwC;;AAQ7CxD,OAAO,CAACO,WAAR,GAAsBA,WAAtB;;AACA,MAAMD,iBAAN,SAAgCmB,OAAO,CAACG,UAAxC,CAAmD;AAC/CyB,EAAAA,MAAM,GAAG;AACL,WAAO3B,WAAW,CAAC4B,SAAZ,CAAsBtD,OAAO,CAACI,MAA9B,EAAsC,IAAtC,CAAP;AACH;;AACY,SAANmD,MAAM,CAACC,KAAD,EAAQ;AACjB,WAAO9B,WAAW,CAAC+B,WAAZ,CAAwBzD,OAAO,CAACI,MAAhC,EAAwCE,iBAAxC,EAA2DkD,KAA3D,CAAP;AACH;;AAN8C;;AAQnDxD,OAAO,CAACM,iBAAR,GAA4BA,iBAA5B;AACA;AACA;AACA;;AACA,MAAMD,MAAN,SAAqBoB,OAAO,CAACI,IAA7B,CAAkC;;AAElC7B,OAAO,CAACK,MAAR,GAAiBA,MAAjB;AACAL,OAAO,CAACI,MAAR,GAAiB,IAAIsD,GAAJ,CAAQ,CACrB,CAACN,SAAD,EAAY;AAAEO,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE,CAC1B,CAAC,SAAD,EAAY,IAAZ,CAD0B,EAE1B,CAAC,MAAD,EAAS,CAAC,EAAD,CAAT,CAF0B;AAA1B,CAAZ,CADqB,EAKrB,CAACtD,iBAAD,EAAoB;AAAEqD,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE,CAClC,CAAC,aAAD,EAAgBrD,WAAhB,CADkC,EAElC,CAAC,WAAD,EAAc6C,SAAd,CAFkC;AAA1B,CAApB,CALqB,EASrB,CAAC7C,WAAD,EAAc;AAAEoD,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE,CAC5B,CAAC,UAAD,EAAa,QAAb,CAD4B,EAE5B,CAAC,WAAD,EAAcjC,UAAU,CAACkC,SAAzB,CAF4B,EAG5B,CAAC,OAAD,EAAU,KAAV,CAH4B,EAI5B,CAAC,YAAD,EAAe,QAAf,CAJ4B,EAK5B,CAAC,WAAD,EAAc,CAAC,EAAD,CAAd,CAL4B,EAM5B,CAAC,SAAD,EAAY,CAACxD,MAAD,CAAZ,CAN4B;AAA1B,CAAd,CATqB,EAiBrB,CAACsB,UAAU,CAACkC,SAAZ,EAAuB;AAAEF,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE,CACrC,CAAC,SAAD,EAAY,IAAZ,CADqC,EAErC,CAAC,MAAD,EAAS,CAAC,EAAD,CAAT,CAFqC;AAA1B,CAAvB,CAjBqB,EAqBrB,CAACzC,SAAD,EAAY;AAAEwC,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE,CAC1B,CAAC,OAAD,EAAU,KAAV,CAD0B,EAE1B,CAAC,YAAD,EAAexC,mBAAf,CAF0B;AAA1B,CAAZ,CArBqB,EAyBrB,CAACA,mBAAD,EAAsB;AAAEuC,EAAAA,IAAI,EAAE,MAAR;AAAgBG,EAAAA,KAAK,EAAE,MAAvB;AAA+BC,EAAAA,MAAM,EAAE,CACjD,CAAC,cAAD,EAAiBzC,sBAAjB,CADiD,EAEjD,CAAC,YAAD,EAAeD,oBAAf,CAFiD;AAAvC,CAAtB,CAzBqB,EA6BrB,CAACC,sBAAD,EAAyB;AAAEqC,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE,CACvC,CAAC,WAAD,EAAc;AAAED,IAAAA,IAAI,EAAE,QAAR;AAAkBK,IAAAA,IAAI,EAAE;AAAxB,GAAd,CADuC,EAEvC,CAAC,YAAD,EAAe,QAAf,CAFuC,EAGvC,CAAC,aAAD,EAAgB,CAAC,QAAD,CAAhB,CAHuC;AAA1B,CAAzB,CA7BqB,EAkCrB,CAAC3C,oBAAD,EAAuB;AAAEsC,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE;AAA1B,CAAvB,CAlCqB,EAmCrB,CAACvD,MAAD,EAAS;AAAEsD,EAAAA,IAAI,EAAE,MAAR;AAAgBG,EAAAA,KAAK,EAAE,MAAvB;AAA+BC,EAAAA,MAAM,EAAE,CACpC,CAAC,eAAD,EAAkB3B,aAAlB,CADoC,EAEpC,CAAC,gBAAD,EAAmBC,cAAnB,CAFoC,EAGpC,CAAC,cAAD,EAAiBC,YAAjB,CAHoC,EAIpC,CAAC,UAAD,EAAaC,QAAb,CAJoC,EAKpC,CAAC,OAAD,EAAUC,KAAV,CALoC,EAMpC,CAAC,QAAD,EAAWC,MAAX,CANoC,EAOpC,CAAC,WAAD,EAAcC,SAAd,CAPoC,EAQpC,CAAC,eAAD,EAAkBC,aAAlB,CARoC;AAAvC,CAAT,CAnCqB,EA6CrB,CAACP,aAAD,EAAgB;AAAEuB,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE;AAA1B,CAAhB,CA7CqB,EA8CrB,CAACvB,cAAD,EAAiB;AAAEsB,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE,CAC/B,CAAC,MAAD,EAAS,CAAC,IAAD,CAAT,CAD+B;AAA1B,CAAjB,CA9CqB,EAiDrB,CAACtB,YAAD,EAAe;AAAEqB,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE,CAC7B,CAAC,YAAD,EAAe,QAAf,CAD6B,EAE7B,CAAC,MAAD,EAAS,CAAC,IAAD,CAAT,CAF6B,EAG7B,CAAC,KAAD,EAAQ,KAAR,CAH6B,EAI7B,CAAC,SAAD,EAAY,MAAZ,CAJ6B;AAA1B,CAAf,CAjDqB,EAuDrB,CAACrB,QAAD,EAAW;AAAEoB,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE,CACzB,CAAC,SAAD,EAAY,MAAZ,CADyB;AAA1B,CAAX,CAvDqB,EA0DrB,CAACpB,KAAD,EAAQ;AAAEmB,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE,CACtB,CAAC,OAAD,EAAU,MAAV,CADsB,EAEtB,CAAC,WAAD,EAAcjC,UAAU,CAACkC,SAAzB,CAFsB;AAA1B,CAAR,CA1DqB,EA8DrB,CAACpB,MAAD,EAAS;AAAEkB,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE,CACvB,CAAC,WAAD,EAAcjC,UAAU,CAACkC,SAAzB,CADuB,EAEvB,CAAC,WAAD,EAAc1C,SAAd,CAFuB;AAA1B,CAAT,CA9DqB,EAkErB,CAACuB,SAAD,EAAY;AAAEiB,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE,CAC1B,CAAC,WAAD,EAAcjC,UAAU,CAACkC,SAAzB,CAD0B;AAA1B,CAAZ,CAlEqB,EAqErB,CAAClB,aAAD,EAAgB;AAAEgB,EAAAA,IAAI,EAAE,QAAR;AAAkBC,EAAAA,MAAM,EAAE,CAC9B,CAAC,eAAD,EAAkB,QAAlB,CAD8B;AAA1B,CAAhB,CArEqB,CAAR,CAAjB;;AAyEA,SAASzD,iBAAT,CAA2B8D,QAA3B,EAAqChB,SAArC,EAAgDhB,UAAhD,EAA4DH,KAA5D,EAAmEoC,OAAnE,EAA4EC,SAA5E,EAAuF;AACnF,SAAO,IAAI5D,WAAJ,CAAgB;AAAE0D,IAAAA,QAAF;AAAYhB,IAAAA,SAAZ;AAAuBnB,IAAAA,KAAvB;AAA8BG,IAAAA,UAA9B;AAA0CiC,IAAAA,OAA1C;AAAmDC,IAAAA;AAAnD,GAAhB,CAAP;AACH;;AACDnE,OAAO,CAACG,iBAAR,GAA4BA,iBAA5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,eAAeiE,qBAAf,CAAqCC,WAArC,EAAkDC,MAAlD,EAA0DC,SAA1D,EAAqEC,SAArE,EAAgF;AAC5E,QAAMC,OAAO,GAAG/C,WAAW,CAAC4B,SAAZ,CAAsBtD,OAAO,CAACI,MAA9B,EAAsCiE,WAAtC,CAAhB;AACA,QAAMK,IAAI,GAAG,IAAIC,UAAJ,CAAepD,WAAW,CAACqD,OAAZ,CAAoBC,MAApB,CAA2BC,KAA3B,CAAiCL,OAAjC,CAAf,CAAb;AACA,QAAMM,SAAS,GAAG,MAAMT,MAAM,CAACU,WAAP,CAAmBP,OAAnB,EAA4BF,SAA5B,EAAuCC,SAAvC,CAAxB;AACA,QAAMS,QAAQ,GAAG,IAAI3E,iBAAJ,CAAsB;AACnC+D,IAAAA,WADmC;AAEnCU,IAAAA,SAAS,EAAE,IAAI3B,SAAJ,CAAc;AAAE8B,MAAAA,OAAO,EAAEb,WAAW,CAACpB,SAAZ,CAAsBiC,OAAjC;AAA0CC,MAAAA,IAAI,EAAEJ,SAAS,CAACA;AAA1D,KAAd;AAFwB,GAAtB,CAAjB;AAIA,SAAO,CAACL,IAAD,EAAOO,QAAP,CAAP;AACH;;AACD,eAAe/E,eAAf,CAA+B,GAAG4C,IAAlC,EAAwC;AACpC,MAAIA,IAAI,CAAC,CAAD,CAAJ,CAAQsC,WAAR,KAAwB7E,WAA5B,EAAyC;AACrC,UAAM,CAAC8D,WAAD,EAAcC,MAAd,EAAsBC,SAAtB,EAAiCC,SAAjC,IAA8C1B,IAApD;AACA,WAAOsB,qBAAqB,CAACC,WAAD,EAAcC,MAAd,EAAsBC,SAAtB,EAAiCC,SAAjC,CAA5B;AACH,GAHD,MAIK;AACD,UAAM,CAACvC,UAAD,EAAaH,KAAb,EAAoBoC,OAApB,EAA6BC,SAA7B,EAAwCG,MAAxC,EAAgDC,SAAhD,EAA2DC,SAA3D,IAAwE1B,IAA9E;AACA,UAAMG,SAAS,GAAG,MAAMqB,MAAM,CAACe,YAAP,CAAoBd,SAApB,EAA+BC,SAA/B,CAAxB;AACA,UAAMH,WAAW,GAAGlE,iBAAiB,CAACoE,SAAD,EAAYtB,SAAZ,EAAuBhB,UAAvB,EAAmCH,KAAnC,EAA0CoC,OAA1C,EAAmDC,SAAnD,CAArC;AACA,WAAOC,qBAAqB,CAACC,WAAD,EAAcC,MAAd,EAAsBC,SAAtB,EAAiCC,SAAjC,CAA5B;AACH;AACJ;;AACDxE,OAAO,CAACE,eAAR,GAA0BA,eAA1B","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.signTransaction = exports.createTransaction = exports.SCHEMA = exports.Action = exports.SignedTransaction = exports.Transaction = exports.deleteAccount = exports.deleteKey = exports.addKey = exports.stake = exports.transfer = exports.functionCall = exports.deployContract = exports.createAccount = exports.IAction = exports.functionCallAccessKey = exports.fullAccessKey = exports.AccessKey = exports.AccessKeyPermission = exports.FullAccessPermission = exports.FunctionCallPermission = void 0;\nconst js_sha256_1 = __importDefault(require(\"js-sha256\"));\nconst enums_1 = require(\"./utils/enums\");\nconst serialize_1 = require(\"./utils/serialize\");\nconst key_pair_1 = require(\"./utils/key_pair\");\nclass FunctionCallPermission extends enums_1.Assignable {\n}\nexports.FunctionCallPermission = FunctionCallPermission;\nclass FullAccessPermission extends enums_1.Assignable {\n}\nexports.FullAccessPermission = FullAccessPermission;\nclass AccessKeyPermission extends enums_1.Enum {\n}\nexports.AccessKeyPermission = AccessKeyPermission;\nclass AccessKey extends enums_1.Assignable {\n}\nexports.AccessKey = AccessKey;\nfunction fullAccessKey() {\n    return new AccessKey({ nonce: 0, permission: new AccessKeyPermission({ fullAccess: new FullAccessPermission({}) }) });\n}\nexports.fullAccessKey = fullAccessKey;\nfunction functionCallAccessKey(receiverId, methodNames, allowance) {\n    return new AccessKey({ nonce: 0, permission: new AccessKeyPermission({ functionCall: new FunctionCallPermission({ receiverId, allowance, methodNames }) }) });\n}\nexports.functionCallAccessKey = functionCallAccessKey;\nclass IAction extends enums_1.Assignable {\n}\nexports.IAction = IAction;\nclass CreateAccount extends IAction {\n}\nclass DeployContract extends IAction {\n}\nclass FunctionCall extends IAction {\n}\nclass Transfer extends IAction {\n}\nclass Stake extends IAction {\n}\nclass AddKey extends IAction {\n}\nclass DeleteKey extends IAction {\n}\nclass DeleteAccount extends IAction {\n}\nfunction createAccount() {\n    return new Action({ createAccount: new CreateAccount({}) });\n}\nexports.createAccount = createAccount;\nfunction deployContract(code) {\n    return new Action({ deployContract: new DeployContract({ code }) });\n}\nexports.deployContract = deployContract;\nfunction functionCall(methodName, args, gas, deposit) {\n    return new Action({ functionCall: new FunctionCall({ methodName, args, gas, deposit }) });\n}\nexports.functionCall = functionCall;\nfunction transfer(deposit) {\n    return new Action({ transfer: new Transfer({ deposit }) });\n}\nexports.transfer = transfer;\nfunction stake(stake, publicKey) {\n    return new Action({ stake: new Stake({ stake, publicKey }) });\n}\nexports.stake = stake;\nfunction addKey(publicKey, accessKey) {\n    return new Action({ addKey: new AddKey({ publicKey, accessKey }) });\n}\nexports.addKey = addKey;\nfunction deleteKey(publicKey) {\n    return new Action({ deleteKey: new DeleteKey({ publicKey }) });\n}\nexports.deleteKey = deleteKey;\nfunction deleteAccount(beneficiaryId) {\n    return new Action({ deleteAccount: new DeleteAccount({ beneficiaryId }) });\n}\nexports.deleteAccount = deleteAccount;\nclass Signature extends enums_1.Assignable {\n}\nclass Transaction extends enums_1.Assignable {\n    encode() {\n        return serialize_1.serialize(exports.SCHEMA, this);\n    }\n    static decode(bytes) {\n        return serialize_1.deserialize(exports.SCHEMA, Transaction, bytes);\n    }\n}\nexports.Transaction = Transaction;\nclass SignedTransaction extends enums_1.Assignable {\n    encode() {\n        return serialize_1.serialize(exports.SCHEMA, this);\n    }\n    static decode(bytes) {\n        return serialize_1.deserialize(exports.SCHEMA, SignedTransaction, bytes);\n    }\n}\nexports.SignedTransaction = SignedTransaction;\n/**\n * Contains a list of the valid transaction Actions available with this API\n */\nclass Action extends enums_1.Enum {\n}\nexports.Action = Action;\nexports.SCHEMA = new Map([\n    [Signature, { kind: 'struct', fields: [\n                ['keyType', 'u8'],\n                ['data', [64]]\n            ] }],\n    [SignedTransaction, { kind: 'struct', fields: [\n                ['transaction', Transaction],\n                ['signature', Signature]\n            ] }],\n    [Transaction, { kind: 'struct', fields: [\n                ['signerId', 'string'],\n                ['publicKey', key_pair_1.PublicKey],\n                ['nonce', 'u64'],\n                ['receiverId', 'string'],\n                ['blockHash', [32]],\n                ['actions', [Action]]\n            ] }],\n    [key_pair_1.PublicKey, { kind: 'struct', fields: [\n                ['keyType', 'u8'],\n                ['data', [32]]\n            ] }],\n    [AccessKey, { kind: 'struct', fields: [\n                ['nonce', 'u64'],\n                ['permission', AccessKeyPermission],\n            ] }],\n    [AccessKeyPermission, { kind: 'enum', field: 'enum', values: [\n                ['functionCall', FunctionCallPermission],\n                ['fullAccess', FullAccessPermission],\n            ] }],\n    [FunctionCallPermission, { kind: 'struct', fields: [\n                ['allowance', { kind: 'option', type: 'u128' }],\n                ['receiverId', 'string'],\n                ['methodNames', ['string']],\n            ] }],\n    [FullAccessPermission, { kind: 'struct', fields: [] }],\n    [Action, { kind: 'enum', field: 'enum', values: [\n                ['createAccount', CreateAccount],\n                ['deployContract', DeployContract],\n                ['functionCall', FunctionCall],\n                ['transfer', Transfer],\n                ['stake', Stake],\n                ['addKey', AddKey],\n                ['deleteKey', DeleteKey],\n                ['deleteAccount', DeleteAccount],\n            ] }],\n    [CreateAccount, { kind: 'struct', fields: [] }],\n    [DeployContract, { kind: 'struct', fields: [\n                ['code', ['u8']]\n            ] }],\n    [FunctionCall, { kind: 'struct', fields: [\n                ['methodName', 'string'],\n                ['args', ['u8']],\n                ['gas', 'u64'],\n                ['deposit', 'u128']\n            ] }],\n    [Transfer, { kind: 'struct', fields: [\n                ['deposit', 'u128']\n            ] }],\n    [Stake, { kind: 'struct', fields: [\n                ['stake', 'u128'],\n                ['publicKey', key_pair_1.PublicKey]\n            ] }],\n    [AddKey, { kind: 'struct', fields: [\n                ['publicKey', key_pair_1.PublicKey],\n                ['accessKey', AccessKey]\n            ] }],\n    [DeleteKey, { kind: 'struct', fields: [\n                ['publicKey', key_pair_1.PublicKey]\n            ] }],\n    [DeleteAccount, { kind: 'struct', fields: [\n                ['beneficiaryId', 'string']\n            ] }],\n]);\nfunction createTransaction(signerId, publicKey, receiverId, nonce, actions, blockHash) {\n    return new Transaction({ signerId, publicKey, nonce, receiverId, actions, blockHash });\n}\nexports.createTransaction = createTransaction;\n/**\n * Signs a given transaction from an account with given keys, applied to the given network\n * @param transaction The Transaction object to sign\n * @param signer The {Signer} object that assists with signing keys\n * @param accountId The human-readable NEAR account name\n * @param networkId The targeted network. (ex. default, devnet, betanet, etc…)\n */\nasync function signTransactionObject(transaction, signer, accountId, networkId) {\n    const message = serialize_1.serialize(exports.SCHEMA, transaction);\n    const hash = new Uint8Array(js_sha256_1.default.sha256.array(message));\n    const signature = await signer.signMessage(message, accountId, networkId);\n    const signedTx = new SignedTransaction({\n        transaction,\n        signature: new Signature({ keyType: transaction.publicKey.keyType, data: signature.signature })\n    });\n    return [hash, signedTx];\n}\nasync function signTransaction(...args) {\n    if (args[0].constructor === Transaction) {\n        const [transaction, signer, accountId, networkId] = args;\n        return signTransactionObject(transaction, signer, accountId, networkId);\n    }\n    else {\n        const [receiverId, nonce, actions, blockHash, signer, accountId, networkId] = args;\n        const publicKey = await signer.getPublicKey(accountId, networkId);\n        const transaction = createTransaction(accountId, publicKey, receiverId, nonce, actions, blockHash);\n        return signTransactionObject(transaction, signer, accountId, networkId);\n    }\n}\nexports.signTransaction = signTransaction;\n"]},"metadata":{},"sourceType":"script"}